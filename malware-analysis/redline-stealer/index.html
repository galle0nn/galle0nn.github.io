<!doctype html><html lang=en><head><title>Redline Stealer Overview ::
The Shipyard</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Sample of Redline Stealer obtained from MalwareBazaar that was initially unpacked by aaqeel87
Analysis # sha256:2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19 md5: f0f9a9448f7a0494d9bf6e11694bfce0 Sample was zip compressed with the password of infected Redline Stealer # Redline Stealer is a malware designed to steal information from infected computers that can be purchased independently or as a subscription. It is typically distributed through phishing emails or malicious websites, and once it infects a system, collects a wide variety of information, including login credentials, banking information and personal data."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://galle0nn.github.io/malware-analysis/redline-stealer/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://galle0nn.github.io/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://galle0nn.github.io/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://galle0nn.github.io/img/favicon.png><link href=/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="Redline Stealer Overview"><meta name=twitter:description content="Analysis of the Redline Stealer malware"><meta property="og:title" content="Redline Stealer Overview"><meta property="og:description" content="Analysis of the Redline Stealer malware"><meta property="og:type" content="article"><meta property="og:url" content="https://galle0nn.github.io/malware-analysis/redline-stealer/"><meta property="article:section" content="malware-analysis"><meta property="article:published_time" content="2023-01-10T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-10T00:00:00+00:00"><meta property="og:site_name" content="The Shipyard"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>cd /home</span>
<span class=logo__cursor></span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/malware-analysis>Malware Analysis</a></li><li><a href=/documents>Documents</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/malware-analysis>Malware Analysis</a></li><li><a href=/documents>Documents</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><article class=post><h1 class=post-title>Redline Stealer Overview</h1><div class=post-meta><time class=post-date>2023-01-10</time></div><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><a href=#redline-stealer>Redline Stealer</a></li><li><a href=#initial-infection-chain>Initial Infection Chain</a></li><li><a href=#static-analysis>Static Analysis</a><ul><li><a href=#floss>floss</a></li><li><a href=#detect-it-easy>Detect it Easy</a></li><li><a href=#dnspy>dnSpy</a></li></ul></li><li><a href=#dynamic-analysis>Dynamic Analysis</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#indicators-of-compromise>Indicators of Compromise</a></li><li><a href=#detection>Detection</a><ul><li><a href=#yara>YARA</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></aside><p>Sample of <em>Redline Stealer</em> obtained from <a href=https://bazaar.abuse.ch/sample/2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19/>MalwareBazaar</a> that was initially unpacked by <a href=https://bazaar.abuse.ch/user/49785277/>aaqeel87</a></p><h1 id=analysis>Analysis
<a href=#analysis class=h-anchor aria-hidden=true>#</a></h1><ul><li>sha256:<code>2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19</code></li><li>md5: <code>f0f9a9448f7a0494d9bf6e11694bfce0</code></li><li>Sample was zip compressed with the password of <em>infected</em></li></ul><h2 id=redline-stealer>Redline Stealer
<a href=#redline-stealer class=h-anchor aria-hidden=true>#</a></h2><p>Redline Stealer is a malware designed to steal information from infected computers that can be purchased independently or as a subscription. It is typically distributed through phishing emails or malicious websites, and once it infects a system, collects a wide variety of information, including login credentials, banking information and personal data.</p><hr><h2 id=initial-infection-chain>Initial Infection Chain
<a href=#initial-infection-chain class=h-anchor aria-hidden=true>#</a></h2><p><strong>Main Symptoms</strong></p><p>Placeholder</p><hr><h2 id=static-analysis>Static Analysis
<a href=#static-analysis class=h-anchor aria-hidden=true>#</a></h2><h3 id=floss>floss
<a href=#floss class=h-anchor aria-hidden=true>#</a></h3><p>Strings of Interest:</p><pre tabindex=0><code>.NETFramework,Version=v4.0
mscorlib
Sliprail.exe
FileZilla
AllWallets
Binance
Discord
E_x0_d_u_S
GameLauncher
Guarda
mYDict
OpenVPN
ProtonVPN
get_IP
set_Location
get_PostalCode
</code></pre><p><em>Figure 1. Strings of Interest</em></p><h3 id=detect-it-easy>Detect it Easy
<a href=#detect-it-easy class=h-anchor aria-hidden=true>#</a></h3><ul><li>32-bit / x86</li><li>Entry point → <strong>0041ec4e</strong></li><li>4D 5A hex (MZ)<ul><li>Portable Executable</li></ul></li></ul><h3 id=dnspy>dnSpy
<a href=#dnspy class=h-anchor aria-hidden=true>#</a></h3><p><strong>Key Points</strong></p><ul><li>Once opened, the file read as <code>Sliprail.exe</code></li><li>XOR key was determined to be <code>Wisecracks</code></li><li>Decoding <code>EntryPoint.IP</code> lead to an address of <code>45.9.20[.]20:13441</code></li><li>Decoding <code>EntryPoint.ID</code> lead to an ID of <code>UTS</code></li></ul><p>Analyzing the <code>EntryPoint</code> class (Figure 2.), encoded strings can be seen along with a notable key string <code>EntryPoint.Key = Wisecracks;</code>. Pairing the key string with what was seen in the <code>StringDecrypt</code> and <code>Program</code> class (Figure 3.), it can be determined that <em>Redline Stealer</em> decodes and decrypts ciphertext using base64 and XOR with the key: <code>Wisecracks</code>.</p><p><img src=images/2.png alt=entrypoint|left> <em>Figure 2. EntryPoint class</em></p><p><img src=images/3.png alt=entrypoint|left>
<em>Figure 3. StringDecrypt class</em></p><h4 id=c2-communication>C2 Communication
<a href=#c2-communication class=h-anchor aria-hidden=true>#</a></h4><p><em>Redline Stealer</em> establishes a connection to the C2 server using <code>EndpointConnection.RequestConnection</code> (Figure 4.), where a request will be sent to the decoded IP address obtained from <code>EntryPoint.IP</code>: <code>net.tcp://45.9.20[.]20:13441/</code></p><p><img src=images/4.png alt="c2 connection|left">
<em>Figure 4. Establishing a connection to the C2 server</em></p><p><strong>Configuration Settings</strong></p><p>If a successful connection is established, the <code>settings</code> object from <code>ScanningArgs</code> will be retrieved, which contains settings on what information to collect from the target system. Each argument name comprises of either a <em>boolean</em> type to enable/disable the collection or a <em>list</em> to collect a string list.</p><table><thead><tr><th>Name</th><th>Type</th></tr></thead><tbody><tr><td>ScanBrowsers</td><td><code>bool</code></td></tr><tr><td>ScanFiles</td><td><code>bool</code></td></tr><tr><td>ScanFTP</td><td><code>bool</code></td></tr><tr><td>ScanWallets</td><td><code>bool</code></td></tr><tr><td>ScanScreen</td><td><code>bool</code></td></tr><tr><td>ScanTelegram</td><td><code>bool</code></td></tr><tr><td>ScanVPN</td><td><code>bool</code></td></tr><tr><td>ScanSteam</td><td><code>bool</code></td></tr><tr><td>ScanDiscord</td><td><code>bool</code></td></tr><tr><td>ScanFilePaths</td><td><code>List&lt;string></code></td></tr><tr><td>BlockedCountry</td><td><code>List&lt;string></code></td></tr><tr><td>BlockedIP</td><td><code>List&lt;string></code></td></tr><tr><td>ScanChromeBrowsersPaths</td><td><code>List&lt;string></code></td></tr><tr><td>ScanGeckoBrowsersPaths</td><td><code>List&lt;string></code></td></tr><tr><td><em>Table 1. Settings to determine what information to collect</em></td><td></td></tr></tbody></table><p><strong>Collected Information Storage</strong></p><p>The results from the data collected are stored in <code>ScanResult</code>. Along with the stored results, <code>ScanDetails</code> was used to invoke more detailed settings for specific applications during the information collection process.</p><p>An example of a specific setting listed by <code>ScanDetails</code> is “Nord”. This particular data member uses the <code>Account</code> class to collect URL, Username and Password information (Figure 5.)</p><table><thead><tr><th><code>ScanResult</code> Names</th><th><code>ScanDetails</code> Names</th></tr></thead><tbody><tr><td>Hardware</td><td>SecurityUtils</td></tr><tr><td>ReleaseID</td><td>AvailableLanguages</td></tr><tr><td>MachineName</td><td>Softwares</td></tr><tr><td>OSVersion</td><td>Processes</td></tr><tr><td>Language</td><td>SystemHardwares</td></tr><tr><td>ScreenSize</td><td>Browsers</td></tr><tr><td><code>ScanDetails</code></td><td>FtpConnections</td></tr><tr><td>Country</td><td>InstalledBrowsers</td></tr><tr><td>City</td><td>ScannedFiles</td></tr><tr><td>TimeZone</td><td>GameLauncherFiles</td></tr><tr><td>IPv4</td><td>Nord</td></tr><tr><td>Monitor</td><td>Open</td></tr><tr><td>ZipCode</td><td>Proton</td></tr><tr><td>FileLocation</td><td>MessageClientFiles</td></tr><tr><td>SeenBefore</td><td>GameChatFiles</td></tr><tr><td><em>Table 2. Data collection results</em></td><td></td></tr></tbody></table><p><img src=images/5.png alt=nord|left> <img src=images/6.png alt=account|left><em>Figure 5. ScanDetails example for Nord</em></p><hr><h2 id=dynamic-analysis>Dynamic Analysis
<a href=#dynamic-analysis class=h-anchor aria-hidden=true>#</a></h2><p>Placeholder</p><h2 id=conclusion>Conclusion
<a href=#conclusion class=h-anchor aria-hidden=true>#</a></h2><p>Placeholder</p><h2 id=indicators-of-compromise>Indicators of Compromise
<a href=#indicators-of-compromise class=h-anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Type</th><th style=text-align:left>Indicator</th><th>Description</th></tr></thead><tbody><tr><td>SHA256</td><td style=text-align:left>2519257a94977d7b877737aa5c3813bbf1c378618eefd472d208fed97320d516</td><td>Redline Stealer Packed</td></tr><tr><td>SHA256</td><td style=text-align:left>2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19</td><td>Redline Stealer Unpacked</td></tr><tr><td>IPv4</td><td style=text-align:left>45.9.20[.]20:13441</td><td>Redline Stealer C2</td></tr></tbody></table><h2 id=detection>Detection
<a href=#detection class=h-anchor aria-hidden=true>#</a></h2><h3 id=yara>YARA
<a href=#yara class=h-anchor aria-hidden=true>#</a></h3><p>Placeholder</p><h2 id=references>References
<a href=#references class=h-anchor aria-hidden=true>#</a></h2></div></article></div><footer class=footer><div>&nbsp; <a href=https://twitter.com/_galle0n target=_blank rel=noopener title=Twitter><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a>&nbsp;&nbsp; <a href=https://github.com/galle0nn target=_blank rel=noopener title=Github><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a>&nbsp;&nbsp; <a href=mailto:galle0nn@protonmail.com target=_blank rel=noopener title=Email><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a>&nbsp;</div><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>cd /home</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2023 galle0n · Powered by the
<a href=https://github.com/panr/hugo-theme-hello-friend target=_blank rel=noopener>Hello Friend</a> theme for <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>