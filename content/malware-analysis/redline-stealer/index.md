---
title: "Redline Stealer Overview"
date: "2023-01-10"
toc: true
description: "Analysis of the Redline Stealer malware"
---

Sample of *Redline Stealer* obtained from [MalwareBazaar](https://bazaar.abuse.ch/sample/2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19/) that was initially unpacked by [aaqeel87](https://bazaar.abuse.ch/user/49785277/)

# Analysis
- sha256:`2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19`
- md5: `f0f9a9448f7a0494d9bf6e11694bfce0`
- Sample was zip compressed with the password of *infected*

## Redline Stealer
Redline Stealer is a malware designed to steal information from infected computers that can be purchased independently or as a subscription. It is typically distributed through phishing emails or malicious websites, and once it infects a system, collects a wide variety of information, including login credentials, banking information and personal data.

****

## Initial Infection Chain
**Main Symptoms**

Placeholder

****

## Static Analysis
### floss
Strings of Interest:
```
.NETFramework,Version=v4.0
mscorlib
Sliprail.exe
FileZilla
AllWallets
Binance
Discord
E_x0_d_u_S
GameLauncher
Guarda
mYDict
OpenVPN
ProtonVPN
get_IP
set_Location
get_PostalCode
```
*Figure 1. Strings of Interest*

### Detect it Easy
- 32-bit / x86
- Entry point → **0041ec4e**
- 4D 5A hex (MZ)
	- Portable Executable

### dnSpy
**Key Points**
- Once opened, the file read as `Sliprail.exe`
- XOR key was determined to be `Wisecracks`
- Decoding `EntryPoint.IP` lead to an address of `45.9.20[.]20:13441`
- Decoding `EntryPoint.ID` lead to an ID of `UTS`

Analyzing the `EntryPoint` class (Figure 2.), encoded strings can be seen along with a notable key string `EntryPoint.Key = Wisecracks;`. Pairing the key string with what was seen in the `StringDecrypt` and `Program` class (Figure 3.), it can be determined that *Redline Stealer* decodes and decrypts ciphertext using base64 and XOR with the key: `Wisecracks`.

![entrypoint|left](<images/2.png>) *Figure 2. EntryPoint class*

![entrypoint|left](<images/3.png>)
*Figure 3. StringDecrypt class*

#### C2 Communication

*Redline Stealer* establishes a connection to the C2 server using `EndpointConnection.RequestConnection` (Figure 4.), where a request will be sent to the decoded IP address obtained from `EntryPoint.IP`: `net.tcp://45.9.20[.]20:13441/`

![c2 connection|left](<images/4.png>)
*Figure 4. Establishing a connection to the C2 server*

**Configuration Settings**

If a successful connection is established, the `settings` object from `ScanningArgs` will be retrieved, which contains settings on what information to collect from the target system. Each argument name comprises of either a *boolean* type to enable/disable the collection or a *list* to collect a string list.

| Name                    | Type           |
| ----------------------- | -------------- |
| ScanBrowsers            | `bool`         |
| ScanFiles               | `bool`         |
| ScanFTP                 | `bool`         |
| ScanWallets             | `bool`         |
| ScanScreen              | `bool`         |
| ScanTelegram            | `bool`         |
| ScanVPN                 | `bool`         |
| ScanSteam               | `bool`         |
| ScanDiscord             | `bool`         |
| ScanFilePaths           | `List<string>` |
| BlockedCountry          | `List<string>` |
| BlockedIP               | `List<string>` |
| ScanChromeBrowsersPaths | `List<string>` |
| ScanGeckoBrowsersPaths  | `List<string>` |
*Table 1. Settings to determine what information to collect*

**Collected Information Storage**

The results from the data collected are stored in `ScanResult`. Along with the stored results, `ScanDetails` was used to invoke more detailed settings for specific applications during the information collection process. 

An example of a specific setting listed by `ScanDetails` is “Nord”. This particular data member uses the `Account` class to collect URL, Username and Password information (Figure 5.)

| `ScanResult` Names | `ScanDetails` Names |
| ------------------ | ------------------- |
| Hardware           | SecurityUtils       |
| ReleaseID          | AvailableLanguages  |
| MachineName        | Softwares           |
| OSVersion          | Processes           |
| Language           | SystemHardwares     |
| ScreenSize         | Browsers            |
| `ScanDetails`      | FtpConnections      |
| Country            | InstalledBrowsers   |
| City               | ScannedFiles        |
| TimeZone           | GameLauncherFiles   |
| IPv4               | Nord                |
| Monitor            | Open                |
| ZipCode            | Proton              |
| FileLocation       | MessageClientFiles  |
| SeenBefore         | GameChatFiles       |
*Table 2. Data collection results*

![nord|left](<images/5.png>) ![account|left](<images/6.png>)*Figure 5. ScanDetails example for Nord*

****


## Dynamic Analysis

Placeholder

## Conclusion

Placeholder


## Indicators of Compromise

| Type   | Indicator                                                        | Description              |
| ------ |:---------------------------------------------------------------- | ------------------------ |
| SHA256 | 2519257a94977d7b877737aa5c3813bbf1c378618eefd472d208fed97320d516 | Redline Stealer Packed   | 
| SHA256 | 2fe3f6fc8b9b9f4d1bddc0e97ddd64229da2a069cf199bcd435d14a3e27e4e19 | Redline Stealer Unpacked |
| IPv4   | 45.9.20[.]20:13441                                               | Redline Stealer C2       |

## Detection
### YARA
Placeholder

## References