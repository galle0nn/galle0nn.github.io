<!doctype html><html lang=en><head><title>The XOR Operator ::
The Shipyard</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Short for exclusive OR Requires only a single machine-code instruction Can be used by malware authors to obfuscate code Also used to encrypt data so that it is only readable when executed Helps malware authors avoid static analysis detection Reversible Uses the same function to encode and decode To decode something encoded with XOR, repeat the XOR function with the same key used during encoding if A is 1 and B is 0, the result is 1 if A is 0 and B is 1, the result is 1 if A is 1 and B is 1, the result is 0 if A is 0 and B is 0, the result is 0 A 1 is returned if exactly one of the inputs is 1 A 0 is returned if both inputs are the same XOR Example # XOR on 4D 5A Converting 4D 5A to its respective bits 4 D 5 A 4 13 5 10 8 4 2 1 8 4 2 1 8 4 2 1 8 4 2 1 0 1 0 0 1 1 0 1 0 1 0 1 1 0 1 0 XOR on 4D 5A bits 4D = 0 1 0 0 1 1 0 1 5A = 0 1 0 1 1 0 1 0 XOR = 0 0 0 1 0 1 1 1 Converting the XOR bits back to hexadecimal 0 0 0 1 0 1 1 1 8 4 2 1 8 4 2 1 1 7 17 Therefore, when XOR of 4D 5A occurs, we will get a hexadecimal result of 17 Identifying XOR Loops # Look for patterns of repeated XOR instructions in disassembly Search for all instances of the XOR instruction within the function and follow the control flow of the code to determine if the XOR operation is being performed in a loop Using the graph view in Cutter/Ghidra can help to visualize the flow of the code and identify any loops An XOR instruction found in disassembly does not necessarily mean that it is being used for encoding and obfuscation Look for certain XOR instructions that could indicate encoding XOR of a register of itself e."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://galle0nn.github.io/documents/xor/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://galle0nn.github.io/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://galle0nn.github.io/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://galle0nn.github.io/img/favicon.png><link href=/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="The XOR Operator"><meta name=twitter:description content="Understanding XOR and how it is used for malware analysis"><meta property="og:title" content="The XOR Operator"><meta property="og:description" content="Understanding XOR and how it is used for malware analysis"><meta property="og:type" content="article"><meta property="og:url" content="https://galle0nn.github.io/documents/xor/"><meta property="article:section" content="documents"><meta property="article:published_time" content="2022-12-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-20T00:00:00+00:00"><meta property="og:site_name" content="The Shipyard"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>cd /home</span>
<span class=logo__cursor></span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/malware-analysis>Malware Analysis</a></li><li><a href=/documents>Documents</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/malware-analysis>Malware Analysis</a></li><li><a href=/documents>Documents</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><article class=post><h1 class=post-title>The XOR Operator</h1><div class=post-meta><time class=post-date>2022-12-20</time></div><div class=post-content><ul><li>Short for <em>exclusive OR</em></li><li>Requires only a single machine-code instruction</li><li>Can be used by malware authors to obfuscate code<ul><li>Also used to encrypt data so that it is only readable when executed<ul><li>Helps malware authors avoid static analysis detection</li></ul></li></ul></li><li>Reversible<ul><li>Uses the same function to encode and decode<ul><li>To decode something encoded with XOR, repeat the XOR function with the same key used during encoding</li></ul></li></ul></li></ul><pre tabindex=0><code>if A is 1 and B is 0, the result is 1
if A is 0 and B is 1, the result is 1
if A is 1 and B is 1, the result is 0
if A is 0 and B is 0, the result is 0
</code></pre><ul><li>A <strong>1</strong> is returned if exactly one of the inputs is <strong>1</strong></li><li>A <strong>0</strong> is returned if both inputs are the <strong>same</strong></li></ul><h2 id=xor-example>XOR Example
<a href=#xor-example class=h-anchor aria-hidden=true>#</a></h2><ul><li>XOR on <code>4D 5A</code></li></ul><pre tabindex=0><code>Converting 4D 5A to its respective bits
4            D            5            A
4            13           5            10
8 4 2 1      8 4 2 1      8 4 2 1      8 4 2 1
0 1 0 0      1 1 0 1      0 1 0 1      1 0 1 0  

XOR on 4D 5A bits
 4D = 0 1 0 0 1 1 0 1
 5A = 0 1 0 1 1 0 1 0
XOR = 0 0 0 1 0 1 1 1

Converting the XOR bits back to hexadecimal
0 0 0 1      0 1 1 1
8 4 2 1      8 4 2 1
1            7
17

Therefore, when XOR of 4D 5A occurs, we will get a hexadecimal result of 17
</code></pre><h2 id=identifying-xor-loops>Identifying XOR Loops
<a href=#identifying-xor-loops class=h-anchor aria-hidden=true>#</a></h2><ul><li>Look for patterns of repeated XOR instructions in disassembly<ul><li>Search for all instances of the XOR instruction within the function and follow the control flow of the code to determine if the XOR operation is being performed in a loop<ul><li>Using the graph view in <strong>Cutter/Ghidra</strong> can help to visualize the flow of the code and identify any loops</li><li>An XOR instruction found in disassembly does not necessarily mean that it is being used for encoding and obfuscation</li></ul></li></ul></li><li>Look for certain XOR instructions that could indicate encoding<ol><li>XOR of a register of itself<ul><li><strong>e.g.</strong> <code>xor eax, eax</code></li><li>Typically used XOR to zero out a register</li><li>Not related to encoding</li></ul></li><li>XOR of a register with a constant<ul><li><strong>e.g</strong> <code>xor edx, 10h</code></li><li>Possible indication of an encoding loop with the key</li></ul></li><li>XOR of one register with a different register<ul><li><strong>e.g</strong> <code>xor eax, ecx</code></li><li>Possible indication of an encoding loop</li></ul></li></ol></li></ul></div></article></div><footer class=footer><div>&nbsp; <a href=https://twitter.com/_galle0n target=_blank rel=noopener title=Twitter><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a>&nbsp;&nbsp; <a href=https://github.com/galle0nn target=_blank rel=noopener title=Github><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a>&nbsp;&nbsp; <a href=mailto:galle0nn@protonmail.com target=_blank rel=noopener title=Email><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a>&nbsp;</div><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>cd /home</span>
<span class=logo__cursor></span></a><div class=copyright><span>Â©2022 - 2023 galle0n</span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>